<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="UTF-8">
  <title>Jogo da Nave</title>
  <style>
    body {
      margin: 0;
      background: radial-gradient(circle at top, #020024, #000000);
      color: white;
      text-align: center;
      font-family: Arial, sans-serif;
    }
    canvas {
      background: black;
      display: block;
      margin: auto;
      border: 2px solid #0ff;
    }
  </style>
</head>
<body>
  <h2>üöÄ Jogo da Nave Espacial</h2>
  <p>‚Üê ‚Üí mover | ‚Üë atirar | R reiniciar</p>
  <canvas id="game" width="900" height="600"></canvas>

  <script>
    const canvas = document.getElementById("game");
    const ctx = canvas.getContext("2d");

    // IMAGENS
    const imgNave = new Image(); imgNave.src = "playerShip1_red.png";
    const imgInimigo = new Image(); imgInimigo.src = "enemyBlue1.png";
    const imgLaserPlayer = new Image(); imgLaserPlayer.src = "laserRed06.png";
    const imgLaserInimigo = new Image(); imgLaserInimigo.src = "laserBlue08.png";
    const imgGameOver = new Image(); imgGameOver.src = "gameover.png";

    // SONS (opcional ‚Äì se falhar no Pages, o jogo continua)
    const somTiro = new Audio("shot.mp3");
    const somExplosao = new Audio("explosion.mp3");
    const somGameOver = new Audio("gameover.mp3");

    const nave = { x: 180, y: 520, w: 40, h: 40, speed: 5, vidas: 3 };
    const tiros = [];
    const inimigos = [];
    const tirosInimigos = [];

    let pontos = 0;
    let recorde = Number(localStorage.getItem("recordeNave")) || 0;
    let fimDeJogo = false;

    const teclas = {};
    document.addEventListener("keydown", e => teclas[e.key] = true);
    document.addEventListener("keyup", e => teclas[e.key] = false);

    let ultimoTiro = 0;
    const intervaloTiro = 250; // limite saud√°vel

    function atirar() {
      const agora = Date.now();
      if (agora - ultimoTiro >= intervaloTiro && !fimDeJogo) {
        ultimoTiro = agora;
        try { somTiro.currentTime = 0; somTiro.play(); } catch {}
        tiros.push({ x: nave.x + nave.w / 2 - 2, y: nave.y, speed: 7 });
      }
    }

    function criarInimigo() {
      if (!fimDeJogo) {
        inimigos.push({ x: Math.random() * 360, y: -40, w: 40, h: 40, speed: 2 });
      }
    }

    setInterval(criarInimigo, 1200);

    function atualizar() {
      if (fimDeJogo) return;

      if (teclas["ArrowLeft"] && nave.x > 0) nave.x -= nave.speed;
      if (teclas["ArrowRight"] && nave.x < 360) nave.x += nave.speed;
      if (teclas["ArrowUp"]) atirar();

      // tiros do jogador
      tiros.forEach(t => t.y -= t.speed);
      for (let i = tiros.length - 1; i >= 0; i--) {
        if (tiros[i].y < -20) tiros.splice(i, 1);
      }

      // inimigos
      inimigos.forEach(i => i.y += i.speed);
      for (let i = inimigos.length - 1; i >= 0; i--) {
        if (inimigos[i].y > canvas.height + 40) inimigos.splice(i, 1);
      }

      // tiros inimigos
      inimigos.forEach(i => {
        if (Math.random() < 0.01) {
          tirosInimigos.push({ x: i.x + 18, y: i.y + 40, speed: 4 });
        }
      });

      tirosInimigos.forEach(t => t.y += t.speed);
      for (let i = tirosInimigos.length - 1; i >= 0; i--) {
        if (tirosInimigos[i].y > canvas.height + 20) tirosInimigos.splice(i, 1);
      }

      colisao();
    }

    function colisao() {
      // tiro do jogador x inimigo
      tiros.forEach((t, ti) => {
        inimigos.forEach((i, ii) => {
          if (t.x < i.x + i.w && t.x + 5 > i.x && t.y < i.y + i.h && t.y + 10 > i.y) {
            try { somExplosao.currentTime = 0; somExplosao.play(); } catch {}
            inimigos.splice(ii, 1);
            tiros.splice(ti, 1);
            pontos += 10;
          }
        });
      });

      // tiro inimigo x nave
      tirosInimigos.forEach((t, ti) => {
        if (t.x < nave.x + nave.w && t.x + 5 > nave.x && t.y < nave.y + nave.h && t.y + 10 > nave.y) {
          tirosInimigos.splice(ti, 1);
          nave.vidas--;
          try { somExplosao.play(); } catch {}
          if (nave.vidas <= 0) gameOver();
        }
      });
    }

    function gameOver() {
      fimDeJogo = true;
      try { somGameOver.play(); } catch {}
      if (pontos > recorde) {
        recorde = pontos;
        localStorage.setItem("recordeNave", recorde);
      }
    }

    document.addEventListener("keydown", e => {
      if (fimDeJogo && e.key.toLowerCase() === 'r') location.reload();
    });

    function desenharHUD() {
      ctx.fillStyle = "white";
      ctx.font = "16px Arial";
      ctx.fillText(`Pontos: ${pontos}`, 10, 20);
      ctx.fillText(`Vidas: ${nave.vidas}`, 10, 40);
      ctx.fillText(`Recorde: ${recorde}`, 10, 60);
    }

    function desenhar() {
      ctx.clearRect(0, 0, canvas.width, canvas.height);

      ctx.drawImage(imgNave, nave.x, nave.y, nave.w, nave.h);
      tiros.forEach(t => ctx.drawImage(imgLaserPlayer, t.x, t.y, 5, 15));
      inimigos.forEach(i => ctx.drawImage(imgInimigo, i.x, i.y, i.w, i.h));
      tirosInimigos.forEach(t => ctx.drawImage(imgLaserInimigo, t.x, t.y, 5, 15));

      desenharHUD();

      if (fimDeJogo) {
        ctx.drawImage(imgGameOver, 40, 200, 320, 200);
      }
    }

    function loop() {
      atualizar();
      desenhar();
      requestAnimationFrame(loop);
    }

    loop();
  </script>
</body>
</html>
